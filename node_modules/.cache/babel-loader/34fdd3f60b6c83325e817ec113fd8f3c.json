{"ast":null,"code":"import _taggedTemplateLiteral from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\rayuv\\\\OneDrive\\\\Documents\\\\GitHub\\\\Reactv\\\\src\\\\components\\\\Epg-Fullscreen\\\\EpgFullListing.js\",\n    _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport styled from \"styled-components\";\nimport { useSelector } from \"react-redux\";\nimport React, { useRef, useEffect } from \"react\";\nimport NavBar from \"./NavBar\";\nimport EpgChannel from \"./EpgChannel\";\nimport TimeBar from \"./TimeBar/TimeBar\";\nimport TimeLongLine from \"./TimeBar/TimeLongLine\";\nimport Popup from \"./Popup\";\nimport focusElement from \"../../other/focused-element\";\nimport { FixedSizeList as List } from \"react-window\";\nimport { convertRemToPixels, convertVhToPixels } from \"../../other/convert-rem\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar Container = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\nposition:absolute;\\ntop:0px;\\nleft:0px;\\nwidth:100vw;\\nheight:100%;\\nmax-height:100vh;\\nbackground-color:white;\\nz-index:20;\\noverflow:hidden;\\n\"])));\n_c = Container;\nvar ChannelsContainer = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\ndisplay: block;\\nheight: calc(100vh - 3.5rem);\\nmargin: 0 auto;\\nflex-grow: 1;\\noverflow-x:hidden;\\n/*overflow: hidden;*/\\n\\n\\n& > div{\\n    display: block;\\n    position: relative;\\n    scrollbar-width: none;\\n    height: 100%;\\n    scroll-behavior: smooth;\\n}\\n\\n& > div > div{\\n    transform: translateY(0px);\\n    position: absolute;\\n    left: 0;\\n    contain: content;\\n    min-width: 408rem;\\n    max-width: 408rem;\\n}\\n\"])));\n_c2 = ChannelsContainer;\nvar EpgChannelsContainer = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\ntop:4rem;\\nmax-height:calc(100vh - 8rem);\\n\"])));\n_c3 = EpgChannelsContainer;\nvar ClosePopup = styled.a(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\ncolor:white;\\nposition:absolute;\\nright:1rem;\\ntop:0.2rem;\\nfont-weight: 500;\\nline-height: 1.2;\\nfont-size: 2.5rem;\\ntransition: all .15s ease;\\nz-index:1000;\\n\\n&:hover{\\n    color: #020d18;\\n    cursor: pointer;\\n}\\n\"])));\n_c4 = ClosePopup;\nvar isScrolling;\n\nvar EpgFullListing = function EpgFullListing() {\n  _s();\n\n  var channelsPlaylist = useSelector(function (state) {\n    return state.playlist;\n  });\n  var playingChannel = useSelector(function (state) {\n    return state.playingCh;\n  });\n  var h24 = useSelector(function (state) {\n    return state.h24;\n  });\n  var history = useHistory();\n\n  var _useParams = useParams(),\n      category = _useParams.category,\n      date = _useParams.date;\n\n  var scrollRef = useRef(null);\n  var listRef = useRef();\n  var day = date ? parseInt((new Date(date) - Date.now()) / (1000 * 60 * 60 * 24), 10) + 1 : 0;\n\n  var executeScroll = function executeScroll() {\n    return day === 0 && scrollRef.current.scroll(new Date().getHours() * 230, 0);\n  };\n\n  var leftScroll = 0;\n  var activeElement;\n  useEffect(function () {\n    playingChannel && listRef.current.scrollToItem(channelsPlaylist.findIndex(function (x) {\n      return x.stream_id === playingChannel.stream_id;\n    }), \"center\");\n    executeScroll();\n    setTimeout(function () {\n      var toSelect = activeElement || document.querySelector(\".isActive\") || document.querySelector(\".noActive\");\n      toSelect && toSelect.focus();\n    }, 50);\n    centerLogo();\n  });\n\n  var centerLogo = function centerLogo(event) {\n    clearTimeout(isScrolling);\n    isScrolling = setTimeout(function () {\n      if (Math.abs(scrollRef.current.scrollLeft - leftScroll) > 100) {\n        leftScroll = scrollRef.current.scrollLeft;\n        Array.from(document.querySelectorAll(\".chLogo\")).forEach(function (x) {\n          return x.style.left = \"calc(\".concat(leftScroll, \"px + 140px)\");\n        });\n      }\n    }, 66);\n  };\n\n  var navButtonScroll = function navButtonScroll(val) {\n    scrollRef.current.scroll({\n      left: scrollRef.current.scrollLeft + val,\n      behavior: 'smooth'\n    });\n  };\n\n  var close = function close() {\n    setTimeout(function () {\n      return document.getElementById(\"selectedCh\") ? document.getElementById(\"selectedCh\").focus() : document.querySelector(\".channel\").focus();\n    }, 100);\n    history.push(\"/live/category/\" + category + \"/\");\n  };\n\n  var moveFocus = function moveFocus(event) {\n    if (event.keyCode === 27 || event.keyCode === 8) {\n      close();\n      return;\n    }\n\n    activeElement = document.activeElement;\n\n    if (event.keyCode === 39 && activeElement.nextSibling) {\n      //window.gSTB && (activeElement.parentNode.parentNode.parentNode.parentNode.scrollLeft=activeElement.nextSibling.style.transform.match(/\\d{1,}\\.{0,}\\d{0,}/g)+\"rem\");\n      activeElement.nextSibling.focus();\n    } else if (event.keyCode === 37 && activeElement.previousSibling) {\n      //window.gSTB && (activeElement.parentNode.parentNode.parentNode.parentNode.scrollLeft=activeElement.previousSibling.style.transform.match(/\\d{1,}\\.{0,}\\d{0,}/g)+\"rem\");\n      activeElement.previousSibling.focus();\n    } else if (event.keyCode === 13) {\n      focusElement.setFocus(activeElement);\n      activeElement.click();\n    } else if (event.keyCode === 40 || event.keyCode === 38) {\n      var start = parseInt(activeElement.dataset.start); //let stop = parseInt(activeElement.dataset.stop);\n\n      var next = activeElement.parentElement.parentElement;\n      next = event.keyCode === 40 ? next.nextElementSibling : next.previousSibling;\n\n      do {\n        if (!next) break;\n        if (next && next.children.length > 1 && next.children[1].children && next.children[1].children.length > 0) break;else next = next = event.keyCode === 40 ? next.nextElementSibling : next.previousSibling;\n      } while (next && !next.children[1].children);\n\n      if (next && next.children[1].children && next.children[1].children.length > 0) {\n        var element = Array.from(next.children[1].children).sort(function (a, b) {\n          var nextStartA = Math.abs(parseInt(a.dataset.start) - start);\n          var nextStartB = Math.abs(parseInt(b.dataset.start) - start); //let nextStopA = Math.abs(parseInt(a.dataset.stop)-stop);\n          //let nextStopB = Math.abs(parseInt(b.dataset.stop)-stop);\n\n          return nextStartA - nextStartB; //> nextStopA-nextStopB ? nextStartA-nextStartB : nextStopA-nextStopB\n        });\n        var toFocus = element[0] || next.children[1].children[0];\n\n        if (toFocus) {\n          toFocus.focus();\n          setTimeout(function () {\n            document.getElementById(toFocus.id) && document.getElementById(toFocus.id).focus();\n          }, 10);\n        }\n      }\n    }\n  };\n\n  var Row = function Row(_ref) {\n    var index = _ref.index,\n        style = _ref.style;\n    return /*#__PURE__*/_jsxDEV(EpgChannel, {\n      day: day,\n      Shift: channelsPlaylist[index].shift,\n      chId: channelsPlaylist[index].stream_id,\n      Name: channelsPlaylist[index].name,\n      Image: channelsPlaylist[index].stream_icon,\n      Epg: channelsPlaylist[index].epg_channel_id,\n      moveFocus: moveFocus,\n      style: style,\n      leftScroll: leftScroll,\n      catchup: channelsPlaylist[index].tv_archive_duration\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }, _this);\n  };\n  /*\n  ORIGINALE:\n  {channelsPlaylist.map((x,id)=> (\n      <EpgChannel day={day} key={id} Name={x.Name} Image={x.Image} Epg={x.Epg} moveFocus={moveFocus}></EpgChannel>\n  ))}\n   <List\n    width={convertRemToPixels(370)}\n    height={convertRemToPixels(50)}\n    itemCount={channelsPlaylist.length}\n    itemSize={convertRemToPixels(10)}\n  >\n    {Row}\n  </List>\n  */\n\n\n  var height = 0;\n  height = convertVhToPixels(\"100vh\") - convertRemToPixels(9);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(NavBar, {\n      day: day\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(ClosePopup, {\n      onClick: close,\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"far fa-times-circle\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 41\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(ChannelsContainer, {\n      style: {\n        overflow: \"auto\"\n      },\n      ref: scrollRef,\n      onScroll: centerLogo,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(TimeBar, {\n          day: day,\n          h24: h24 === \"HH:MM\",\n          scrollBtn: navButtonScroll\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(EpgChannelsContainer, {\n          children: [/*#__PURE__*/_jsxDEV(List, {\n            height: height,\n            itemCount: channelsPlaylist.length,\n            itemSize: convertRemToPixels(10),\n            style: {\n              overflowX: \"hidden\",\n              overflowY: \"auto\",\n              bottom: 0,\n              marginTop: \"0.6rem\"\n            },\n            ref: listRef,\n            useIsScrolling: true,\n            children: Row\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 25\n          }, _this), day === 0 && /*#__PURE__*/_jsxDEV(TimeLongLine, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 40\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 21\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(Popup, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 202,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(EpgFullListing, \"NJsQt0jo2+RsjW0LUHaEEeIL/gY=\", false, function () {\n  return [useSelector, useSelector, useSelector, useHistory, useParams];\n});\n\n_c5 = EpgFullListing;\nexport default EpgFullListing;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"ChannelsContainer\");\n$RefreshReg$(_c3, \"EpgChannelsContainer\");\n$RefreshReg$(_c4, \"ClosePopup\");\n$RefreshReg$(_c5, \"EpgFullListing\");","map":{"version":3,"sources":["C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/src/components/Epg-Fullscreen/EpgFullListing.js"],"names":["styled","useSelector","React","useRef","useEffect","NavBar","EpgChannel","TimeBar","TimeLongLine","Popup","focusElement","FixedSizeList","List","convertRemToPixels","convertVhToPixels","useHistory","useParams","Container","div","ChannelsContainer","EpgChannelsContainer","ClosePopup","a","isScrolling","EpgFullListing","channelsPlaylist","state","playlist","playingChannel","playingCh","h24","history","category","date","scrollRef","listRef","day","parseInt","Date","now","executeScroll","current","scroll","getHours","leftScroll","activeElement","scrollToItem","findIndex","x","stream_id","setTimeout","toSelect","document","querySelector","focus","centerLogo","event","clearTimeout","Math","abs","scrollLeft","Array","from","querySelectorAll","forEach","style","left","navButtonScroll","val","behavior","close","getElementById","push","moveFocus","keyCode","nextSibling","previousSibling","setFocus","click","start","dataset","next","parentElement","nextElementSibling","children","length","element","sort","b","nextStartA","nextStartB","toFocus","id","Row","index","shift","name","stream_icon","epg_channel_id","tv_archive_duration","height","overflow","overflowX","overflowY","bottom","marginTop"],"mappings":"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","sourcesContent":["import styled from \"styled-components\"\nimport {useSelector} from \"react-redux\"\nimport React, {useRef,useEffect} from \"react\"\nimport NavBar from \"./NavBar\"\nimport EpgChannel from \"./EpgChannel\"\nimport TimeBar from \"./TimeBar/TimeBar\"\nimport TimeLongLine from \"./TimeBar/TimeLongLine\"\nimport Popup from \"./Popup\"\nimport focusElement from \"../../other/focused-element\"\nimport { FixedSizeList as List } from \"react-window\";\nimport {convertRemToPixels,convertVhToPixels} from \"../../other/convert-rem\"\nimport {useHistory, useParams} from \"react-router-dom\";\n\n\nconst Container = styled.div`\nposition:absolute;\ntop:0px;\nleft:0px;\nwidth:100vw;\nheight:100%;\nmax-height:100vh;\nbackground-color:white;\nz-index:20;\noverflow:hidden;\n`\n\nconst ChannelsContainer = styled.div`\ndisplay: block;\nheight: calc(100vh - 3.5rem);\nmargin: 0 auto;\nflex-grow: 1;\noverflow-x:hidden;\n/*overflow: hidden;*/\n\n\n& > div{\n    display: block;\n    position: relative;\n    scrollbar-width: none;\n    height: 100%;\n    scroll-behavior: smooth;\n}\n\n& > div > div{\n    transform: translateY(0px);\n    position: absolute;\n    left: 0;\n    contain: content;\n    min-width: 408rem;\n    max-width: 408rem;\n}\n`\n\nconst EpgChannelsContainer = styled.div`\ntop:4rem;\nmax-height:calc(100vh - 8rem);\n`\n\nconst ClosePopup = styled.a`\ncolor:white;\nposition:absolute;\nright:1rem;\ntop:0.2rem;\nfont-weight: 500;\nline-height: 1.2;\nfont-size: 2.5rem;\ntransition: all .15s ease;\nz-index:1000;\n\n&:hover{\n    color: #020d18;\n    cursor: pointer;\n}\n`\n\nlet isScrolling;\nconst EpgFullListing = () => {\n    const channelsPlaylist = useSelector(state => state.playlist);\n    const playingChannel = useSelector(state => state.playingCh);\n    const h24 = useSelector(state => state.h24);\n\n    const history = useHistory();\n    const {category, date} = useParams();\n    const scrollRef = useRef(null)\n    const listRef = useRef();\n\n    const day = date ? parseInt((new Date(date) - Date.now()) / (1000 * 60 * 60 * 24), 10)+1 : 0;\n\n\n\n\n    const executeScroll = () => day === 0 && (scrollRef.current.scroll(new Date().getHours()*230,0));\n\n    let leftScroll = 0;\n    \n    let activeElement;\n    useEffect(() => {\n        playingChannel && (listRef.current.scrollToItem(channelsPlaylist.findIndex(x=>x.stream_id === playingChannel.stream_id), \"center\"));\n        executeScroll();\n        setTimeout(()=>{\n            let toSelect = activeElement || document.querySelector(\".isActive\") || document.querySelector(\".noActive\")\n            toSelect && (toSelect.focus())\n        },50)\n        centerLogo();\n    })\n\n    const centerLogo = (event) =>{\n        clearTimeout( isScrolling );\n        isScrolling = setTimeout(function() {\n            if(Math.abs(scrollRef.current.scrollLeft-leftScroll)>100){\n                leftScroll = scrollRef.current.scrollLeft;\n                Array.from(document.querySelectorAll(\".chLogo\")).forEach(x=> x.style.left = `calc(${leftScroll}px + 140px)`)\n            }\n        }, 66);\n    }\n\n    const navButtonScroll = (val) =>{\n        scrollRef.current.scroll({left:scrollRef.current.scrollLeft+val,behavior: 'smooth'})\n    }\n\n    const close = () =>{\n        setTimeout(()=>document.getElementById(\"selectedCh\") ? document.getElementById(\"selectedCh\").focus() : document.querySelector(\".channel\").focus(),100)\n        history.push(\"/live/category/\"+category+\"/\")\n    }\n\n    const moveFocus = (event) => {\n        if(event.keyCode === 27 || event.keyCode === 8){\n            close();\n            return;\n        }\n\n        activeElement = document.activeElement;\n        if(event.keyCode === 39 && activeElement.nextSibling) {\n            //window.gSTB && (activeElement.parentNode.parentNode.parentNode.parentNode.scrollLeft=activeElement.nextSibling.style.transform.match(/\\d{1,}\\.{0,}\\d{0,}/g)+\"rem\");\n            activeElement.nextSibling.focus();\n        }\n        else if(event.keyCode === 37 && activeElement.previousSibling) {\n            //window.gSTB && (activeElement.parentNode.parentNode.parentNode.parentNode.scrollLeft=activeElement.previousSibling.style.transform.match(/\\d{1,}\\.{0,}\\d{0,}/g)+\"rem\");\n            activeElement.previousSibling.focus();\n        }else if(event.keyCode === 13) {\n            focusElement.setFocus(activeElement);\n            activeElement.click();\n        }else if(event.keyCode === 40 || event.keyCode === 38) {\n            let start = parseInt(activeElement.dataset.start);\n            //let stop = parseInt(activeElement.dataset.stop);\n\n            let next = activeElement.parentElement.parentElement;\n            next = event.keyCode === 40 ? next.nextElementSibling : next.previousSibling;\n            do{\n                if(!next)\n                    break;\n                if(next && next.children.length > 1 && next.children[1].children && next.children[1].children.length > 0)\n                    break;\n                else next = next = event.keyCode === 40 ? next.nextElementSibling : next.previousSibling;\n            }while(next &&  !next.children[1].children)\n            if(next && next.children[1].children && next.children[1].children.length > 0){\n                \n                let element = Array.from(next.children[1].children).sort((a,b) => {\n                    let nextStartA = Math.abs(parseInt(a.dataset.start)-start);\n                    let nextStartB = Math.abs(parseInt(b.dataset.start)-start);\n\n                    //let nextStopA = Math.abs(parseInt(a.dataset.stop)-stop);\n                    //let nextStopB = Math.abs(parseInt(b.dataset.stop)-stop);\n                    \n                    return nextStartA-nextStartB //> nextStopA-nextStopB ? nextStartA-nextStartB : nextStopA-nextStopB\n                })\n\n                let toFocus = element[0] || next.children[1].children[0];\n                if(toFocus){\n                    toFocus.focus();\n                    setTimeout(() => {\n                        document.getElementById(toFocus.id) && (document.getElementById(toFocus.id).focus())\n                    }, 10);\n                }\n            }\n        }\n    }\n\n    const Row = ({ index, style }) => (\n        <EpgChannel day={day} Shift={channelsPlaylist[index].shift} chId={channelsPlaylist[index].stream_id} key={index} Name={channelsPlaylist[index].name} Image={channelsPlaylist[index].stream_icon} Epg={channelsPlaylist[index].epg_channel_id} moveFocus={moveFocus} style={style} leftScroll={leftScroll} catchup={channelsPlaylist[index].tv_archive_duration}></EpgChannel>\n      );\n    /*\n    ORIGINALE:\n    {channelsPlaylist.map((x,id)=> (\n        <EpgChannel day={day} key={id} Name={x.Name} Image={x.Image} Epg={x.Epg} moveFocus={moveFocus}></EpgChannel>\n    ))}\n\n    <List\n      width={convertRemToPixels(370)}\n      height={convertRemToPixels(50)}\n      itemCount={channelsPlaylist.length}\n      itemSize={convertRemToPixels(10)}\n    >\n      {Row}\n    </List>\n    */\n\n    let height = 0;\n    height = convertVhToPixels(\"100vh\")-convertRemToPixels(9)\n\n    return (\n        <Container>\n            <NavBar day={day}></NavBar>\n            <ClosePopup onClick={close}><i className=\"far fa-times-circle\"></i></ClosePopup>\n            <ChannelsContainer style={{overflow:\"auto\"}}   ref={scrollRef} onScroll={centerLogo} >\n                <div>\n                    <TimeBar day={day} h24={h24===\"HH:MM\"} scrollBtn={navButtonScroll}/>\n                    <EpgChannelsContainer>\n                        <List\n                          height={height}\n                          itemCount={channelsPlaylist.length}\n                          itemSize={convertRemToPixels(10)}\n                          style={{overflowX:\"hidden\", overflowY:\"auto\", bottom:0, marginTop:\"0.6rem\"}}\n                          ref = {listRef}\n                          useIsScrolling={true}\n                        >\n                          {Row}\n                        </List>\n                        {day === 0 && (<TimeLongLine/>)}\n                    </EpgChannelsContainer>\n                </div>\n            </ChannelsContainer>\n            <Popup/>\n        </Container>\n    )\n}\n\nexport default EpgFullListing\n\n"]},"metadata":{},"sourceType":"module"}