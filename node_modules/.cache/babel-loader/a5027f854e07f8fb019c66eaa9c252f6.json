{"ast":null,"code":"import _objectSpread from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _slicedToArray from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\rayuv\\\\OneDrive\\\\Documents\\\\GitHub\\\\Reactv\\\\src\\\\other\\\\auth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nimport React, { useState, useContext, createContext } from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\nimport * as axios from \"./axios\";\nimport { setInfo } from \"./user_info\";\nimport Cookies from 'js-cookie';\nimport { initDb } from \"./local-db\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar authContext = /*#__PURE__*/createContext();\nexport function ProvideAuth(_ref) {\n  _s();\n\n  var children = _ref.children;\n  var auth = useProvideAuth();\n  return /*#__PURE__*/_jsxDEV(authContext.Provider, {\n    value: auth,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 12,\n    columnNumber: 10\n  }, this);\n}\n\n_s(ProvideAuth, \"XNU4Jn8u4aVzJknlKOHFJq03xMo=\", false, function () {\n  return [useProvideAuth];\n});\n\n_c = ProvideAuth;\nexport var useAuth = function useAuth() {\n  _s2();\n\n  return useContext(authContext);\n};\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport function useProvideAuth() {\n  _s3();\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      auth = _useState2[0],\n      setAuth = _useState2[1];\n\n  var signin = function signin(dns, username, password, successFallback, failFallback) {\n    if (dns) axios.setDns(dns);\n    axios.post(\"player_api.php\", {\n      username: username.trim(),\n      password: password.trim()\n    }).then(function (result) {\n      if (result) {\n        if (result.data) result = result.data;else if (result.response && result.response.data) result = result.response.data;\n      }\n\n      if (result && result.user_info) {\n        if (result.iptveditor) axios.setDns(\"\".concat(process.env.REACT_APP_IPTVEDITOR_API, \"webplayer\"));\n        if (result.user_info.auth === 0) failFallback(\"No account found\", \"No account found with inserted credentials.\" + (window.location.host.includes(\"iptveditor.com\") ? \"<br/>To login use your IPTVEditor's playlist username and password, not your email.\" : \"\"));else if (result.user_info.auth) {\n          if (result.user_info.status !== \"Active\") failFallback(\"Account expired\", \"Account expired on \".concat(new Date(parseInt(result.user_info.exp_date + \"000\")).toGMTString()));else {\n            setAuth(1);\n            setInfo(result.user_info, result.server_info);\n            initDb();\n            successFallback && successFallback();\n          }\n        }\n      } else if (result.title) {\n        failFallback && failFallback(result.title, result.body);\n      } else {\n        failFallback && failFallback(\"Server error\", \"Server didn't generated any reply. Please try later #2\");\n      }\n    }).catch(function (err) {\n      console.log(err);\n      if (err && err.response && err.response.data && err.response.data.user_info && err.response.data.user_info.auth === 0) failFallback && failFallback(\"No account found\", \"No account found with inserted credentials.\" + (window.location.host.includes(\"iptveditor.com\") ? \"<br/>To login use your IPTVEditor's playlist username and password, not your email.\" : \"\"));else failFallback && failFallback(\"Server error\", \"Server didn't generated any reply. Please try later #1\");\n    });\n  };\n\n  var authLogin = function authLogin(fallback) {\n    var dns = window.dns.length === 0 && Cookies.get(\"dns\");\n    var username = Cookies.get(\"username\");\n    var password = Cookies.get(\"password\");\n    if (username && password) signin(dns, username, password, fallback);\n  };\n\n  var signout = function signout(action) {\n    setAuth(null);\n    action && action();\n  };\n\n  var isAuth = function isAuth() {\n    return !!auth;\n  };\n\n  return {\n    signin: signin,\n    signout: signout,\n    isAuth: isAuth,\n    authLogin: authLogin\n  };\n}\n\n_s3(useProvideAuth, \"J/Rf+j/6ccJPq4kxqIIGfY0vqy4=\");\n\nexport function PrivateRoute(_ref2) {\n  _s4();\n\n  var _this = this;\n\n  var children = _ref2.children,\n      rest = _objectWithoutProperties(_ref2, [\"children\"]);\n\n  var auth = useAuth();\n  return /*#__PURE__*/_jsxDEV(Route, _objectSpread(_objectSpread({}, rest), {}, {\n    render: function render(_ref3) {\n      var location = _ref3.location;\n      return auth.isAuth() ? children : /*#__PURE__*/_jsxDEV(Redirect, {\n        to: {\n          pathname: \"/login/\",\n          state: {\n            from: location\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }, _this);\n    }\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n}\n\n_s4(PrivateRoute, \"YuJWYXaKIY31b1y7U6yy3IXSxQA=\", false, function () {\n  return [useAuth];\n});\n\n_c2 = PrivateRoute;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ProvideAuth\");\n$RefreshReg$(_c2, \"PrivateRoute\");","map":{"version":3,"sources":["C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/src/other/auth.js"],"names":["React","useState","useContext","createContext","Route","Redirect","axios","setInfo","Cookies","initDb","authContext","ProvideAuth","children","auth","useProvideAuth","useAuth","setAuth","signin","dns","username","password","successFallback","failFallback","setDns","post","trim","then","result","data","response","user_info","iptveditor","process","env","REACT_APP_IPTVEDITOR_API","window","location","host","includes","status","Date","parseInt","exp_date","toGMTString","server_info","title","body","catch","err","console","log","authLogin","fallback","length","get","signout","action","isAuth","PrivateRoute","rest","pathname","state","from"],"mappings":"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","sourcesContent":["import React, { useState, useContext, createContext } from \"react\";\nimport {Route,Redirect} from \"react-router-dom\"\nimport * as axios from \"./axios\";\nimport {setInfo} from \"./user_info\"\nimport Cookies from 'js-cookie'\nimport {initDb} from \"./local-db\"\n\nconst authContext = createContext();\n\nexport function ProvideAuth({ children }) {\n  const auth = useProvideAuth();\n  return <authContext.Provider value={auth}>{children}</authContext.Provider>;\n}\n\nexport const useAuth = () => {\n  return useContext(authContext);\n};\n\nexport function useProvideAuth() {\n  const [auth, setAuth] = useState(0);\n\n  const signin = (dns, username, password, successFallback, failFallback) => {\n    if(dns)\n      axios.setDns(dns);\n      \n    axios.post(\"player_api.php\",{\n      username: username.trim(),\n      password: password.trim(),\n    }).then(result => {\n      if(result){\n        if(result.data)\n          result = result.data\n        else if(result.response && result.response.data)\n          result = result.response.data\n      }\n      if(result && result.user_info){\n        if(result.iptveditor)\n          axios.setDns(`${process.env.REACT_APP_IPTVEDITOR_API}webplayer`);\n        if(result.user_info.auth === 0)\n          failFallback(\"No account found\",\"No account found with inserted credentials.\" + (window.location.host.includes(\"iptveditor.com\") ? \"<br/>To login use your IPTVEditor's playlist username and password, not your email.\" : \"\"));\n        else if(result.user_info.auth){\n          if(result.user_info.status !== \"Active\")\n            failFallback(\"Account expired\",`Account expired on ${new Date(parseInt(result.user_info.exp_date+\"000\")).toGMTString()}`);\n          else {\n            setAuth(1);\n            setInfo(result.user_info, result.server_info);\n            initDb();\n            successFallback && (successFallback());\n\n          }\n        }\n      }else if(result.title){\n        failFallback && (failFallback(result.title,result.body));\n      }else{\n        failFallback && (failFallback(\"Server error\",\"Server didn't generated any reply. Please try later #2\"));\n      }\n    }).catch(err => {\n      console.log(err);\n      if(err && err.response && err.response.data && err.response.data.user_info && err.response.data.user_info.auth === 0)\n        failFallback && (failFallback(\"No account found\",\"No account found with inserted credentials.\" + (window.location.host.includes(\"iptveditor.com\") ? \"<br/>To login use your IPTVEditor's playlist username and password, not your email.\" : \"\")));\n      else failFallback && (failFallback(\"Server error\",\"Server didn't generated any reply. Please try later #1\"));\n    })\n  };\n\n  const authLogin = (fallback) =>{\n\n    const dns = window.dns.length === 0 && (Cookies.get(\"dns\")) ;\n    const username = Cookies.get(\"username\");\n    const password = Cookies.get(\"password\");\n\n    if(username && password)\n      signin(dns,username,password,fallback);      \n  }\n\n  const signout = (action) => {\n    setAuth(null);\n    action && (action());\n  };\n\n  const isAuth = () => {\n    return !!auth;\n  }\n\n  return {\n    signin,\n    signout,\n    isAuth,\n    authLogin\n  };\n}\n\n\nexport function PrivateRoute({ children, ...rest }) {\n  let auth = useAuth();\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        auth.isAuth() ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: \"/login/\",\n              state: { from: location }\n            }}\n          />\n        )\n      }\n    />\n  );\n}"]},"metadata":{},"sourceType":"module"}