{"ast":null,"code":"import _slicedToArray from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\rayuv\\\\OneDrive\\\\Documents\\\\GitHub\\\\Reactv\\\\src\\\\components\\\\Player\\\\Player.js\",\n    _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useRef, useState, useEffect } from \"react\";\nimport ReactPlayer from 'react-player';\nimport { useSelector } from \"react-redux\";\nimport Fullscreen from \"../Live/Fullscreen.js\";\nimport Button from \"./Buttons/Button\";\nimport VolumeButton from \"./Buttons/VolumeButton\";\nimport PiPButton from \"./Buttons/PiPButton\";\nimport { generateUrl, catchupUrlGenerator, convertTsToM3u8 } from \"../../other/generate-url\";\nimport { Loading } from '../../other/Player-github/style';\nimport \"./Player.css\";\nimport styled from \"styled-components\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar PlayerDiv = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\nwidth: 100%;\\nbackground: #0000003d;\\npadding: 0.7rem;\\nborder-radius: 0.4rem;\\nheight: 40vh;\\nposition: relative;\\noverflow: hidden;\\nuser-select:none;\\n\"])));\n_c = PlayerDiv;\nvar ContainerButtons = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\ndisplay: flex;\\nwidth: 100%;\\nposition: absolute;\\nbottom: 0;\\nleft: 0;\\nright: 0;\\nheight: 3em;\\nbackground-color: rgba(43, 51, 63, 0.7);\\ncolor: white;\\ntransition:  bottom .5s ease;\\n\"])));\n_c2 = ContainerButtons;\nvar Spin = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\nheight: 100%;\\noverflow: auto;\\noverflow-y: auto;\\nmax-width: 100%;\\nwidth: 100%;\\noverflow-x: hidden;\\nbackground-color: transparent;\\nposition: absolute;\\nz-index: 5;\\ntop: 0;\\nleft: 0;\\n\\ndisplay:flex;\\njustify-content:center;\\nalign-items:center;\\n\\n\"])));\n_c3 = Spin;\nvar timeout = null;\n\nvar Player = function Player() {\n  _s();\n\n  var ref = useRef();\n  var playingChannel = useSelector(function (state) {\n    return state.playingCh || {\n      disabled: true\n    };\n  });\n\n  var _useState = useState(!!playingChannel),\n      _useState2 = _slicedToArray(_useState, 2),\n      play = _useState2[0],\n      setPlay = _useState2[1];\n\n  var _useState3 = useState(50),\n      _useState4 = _slicedToArray(_useState3, 2),\n      volume = _useState4[0],\n      setVolume = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      pip = _useState6[0],\n      setPip = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      fullscreen = _useState8[0],\n      setFullscreen = _useState8[1];\n\n  var _useState9 = useState({\n    bottom: \"-3rem\"\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      hoverStyle = _useState10[0],\n      setHoverStyle = _useState10[1];\n\n  var _useState11 = useState({\n    cursor: \"\"\n  }),\n      _useState12 = _slicedToArray(_useState11, 2),\n      showCursor = _useState12[0],\n      setShowCursor = _useState12[1];\n\n  var _useState13 = useState(),\n      _useState14 = _slicedToArray(_useState13, 2),\n      url = _useState14[0],\n      setUrl = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      isLoading = _useState16[0],\n      setIsLoading = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      error = _useState18[0],\n      setError = _useState18[1];\n\n  useEffect(function () {\n    if (ref.current) {\n      var elem = ref.current;\n\n      if (fullscreen) {\n        if (elem.requestFullscreen) {\n          elem.requestFullscreen();\n        } else if (elem.webkitRequestFullscreen) {\n          /* Safari */\n          elem.webkitRequestFullscreen();\n        } else if (elem.msRequestFullscreen) {\n          /* IE11 */\n          elem.msRequestFullscreen();\n        }\n\n        showOverlayTimer();\n      } else {\n        setShowCursor({\n          cursor: \"\"\n        });\n\n        if (document.exitFullscreen) {\n          document.exitFullscreen().catch(function () {});\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    }\n  }, [fullscreen]);\n  useEffect(function () {\n    if (!play) showOverlay(true);\n  }, [play]);\n  useEffect(function () {\n    if (!playingChannel || playingChannel.disabled) {\n      setIsLoading(false);\n      return;\n    }\n\n    setError(false);\n    var ip = playingChannel.direct_source ? convertTsToM3u8(playingChannel.direct_source) : generateUrl(\"live\", playingChannel.stream_id, \"m3u8\");\n    if (playingChannel.timeshift) ip = catchupUrlGenerator(ip, playingChannel.timeshift, playingChannel.duration);\n    setUrl(ip);\n    setPlay(true);\n  }, [playingChannel]);\n\n  var showOverlay = function showOverlay(show) {\n    setShowCursor({\n      cursor: \"\"\n    });\n    setHoverStyle({\n      bottom: show ? \"0rem\" : \"-3rem\"\n    });\n  };\n\n  var showOverlayTimer = function showOverlayTimer() {\n    setShowCursor({\n      cursor: \"\"\n    });\n    clearTimeout(timeout);\n    showOverlay(true);\n    timeout = setTimeout(function () {\n      showOverlay(false);\n      setShowCursor({\n        cursor: \"none\"\n      });\n    }, 4000);\n  };\n\n  return /*#__PURE__*/_jsxDEV(PlayerDiv, {\n    ref: ref,\n    onDoubleClick: function onDoubleClick() {\n      return setFullscreen(!fullscreen);\n    },\n    onMouseEnter: function onMouseEnter() {\n      return showOverlay(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return showOverlay(false);\n    },\n    onMouseMove: function onMouseMove() {\n      return fullscreen && showOverlayTimer();\n    },\n    style: showCursor,\n    children: [/*#__PURE__*/_jsxDEV(ReactPlayer, {\n      className: \"react-player\",\n      width: \"100%\",\n      height: \"100%\",\n      playing: play,\n      volume: volume / 100,\n      url: url,\n      pip: pip,\n      controls: false,\n      onProgress: function onProgress(state) {\n        setError(false);\n      },\n      onPlay: function onPlay() {\n        setError(false);\n      },\n      onError: function onError(error, data) {\n        setError(true);\n        setIsLoading(false);\n      },\n      onBufferEnd: function onBufferEnd() {\n        setError(false);\n        setIsLoading(false);\n      },\n      onBuffer: function onBuffer() {\n        setIsLoading(true);\n        setError(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 9\n    }, _this), isLoading === true && /*#__PURE__*/_jsxDEV(Spin, {\n      children: /*#__PURE__*/_jsxDEV(Loading, {\n        color: \"var(--second-color);\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 19\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 19\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 19\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 17\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 13\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 34\n    }, _this), error === true ? /*#__PURE__*/_jsxDEV(Spin, {\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          color: \"white\"\n        },\n        children: \"An error occurred. Can't play stream.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 28\n    }, _this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Fullscreen, {\n        externalShow: fullscreen && hoverStyle.bottom !== \"-3rem\",\n        cTitle: playingChannel.title,\n        cDesc: playingChannel.desc,\n        cDuration: playingChannel.duration\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(ContainerButtons, {\n        dir: \"ltr\",\n        style: hoverStyle,\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          enabled: play,\n          onClick: function onClick() {\n            return setPlay(!play);\n          },\n          iconOn: \"fas fa-play\",\n          iconOff: \"fas fa-pause\",\n          textOn: \"Play\",\n          textOff: \"Pause\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 10\n        }, _this), /*#__PURE__*/_jsxDEV(VolumeButton, {\n          enabled: volume === 0,\n          onClick: function onClick() {\n            return setVolume(0);\n          },\n          onChangeInput: function onChangeInput(e) {\n            return setVolume(e.target.value);\n          },\n          volume: volume\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(PiPButton, {\n          enabled: pip,\n          onClick: function onClick() {\n            return setPip(!pip);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(Button, {\n          enabled: fullscreen,\n          onClick: function onClick() {\n            return setFullscreen(!fullscreen);\n          },\n          iconOn: \"fas fa-expand\",\n          iconOff: \"fas fa-compress\",\n          textOn: \"Fullscreen\",\n          textOff: \"Exit fullscreen\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 7\n  }, _this);\n};\n\n_s(Player, \"9F8JuVm21TIaBEUpJd3jgYVf0u4=\", false, function () {\n  return [useSelector];\n});\n\n_c4 = Player;\nexport default Player;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"PlayerDiv\");\n$RefreshReg$(_c2, \"ContainerButtons\");\n$RefreshReg$(_c3, \"Spin\");\n$RefreshReg$(_c4, \"Player\");","map":{"version":3,"sources":["C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/src/components/Player/Player.js"],"names":["React","useRef","useState","useEffect","ReactPlayer","useSelector","Fullscreen","Button","VolumeButton","PiPButton","generateUrl","catchupUrlGenerator","convertTsToM3u8","Loading","styled","PlayerDiv","div","ContainerButtons","Spin","timeout","Player","ref","playingChannel","state","playingCh","disabled","play","setPlay","volume","setVolume","pip","setPip","fullscreen","setFullscreen","bottom","hoverStyle","setHoverStyle","cursor","showCursor","setShowCursor","url","setUrl","isLoading","setIsLoading","error","setError","current","elem","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","showOverlayTimer","document","exitFullscreen","catch","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","showOverlay","ip","direct_source","stream_id","timeshift","duration","show","clearTimeout","setTimeout","data","color","title","desc","e","target","value"],"mappings":"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","sourcesContent":["import React, {useRef,useState,useEffect} from \"react\"\nimport ReactPlayer from 'react-player'\nimport {useSelector} from \"react-redux\"\nimport Fullscreen from \"../Live/Fullscreen.js\"\nimport Button from \"./Buttons/Button\"\nimport VolumeButton from \"./Buttons/VolumeButton\"\nimport PiPButton from \"./Buttons/PiPButton\"\nimport {generateUrl, catchupUrlGenerator, convertTsToM3u8} from \"../../other/generate-url\"\nimport {Loading} from '../../other/Player-github/style';\n\nimport \"./Player.css\"\n\nimport styled from \"styled-components\"\nconst PlayerDiv = styled.div`\nwidth: 100%;\nbackground: #0000003d;\npadding: 0.7rem;\nborder-radius: 0.4rem;\nheight: 40vh;\nposition: relative;\noverflow: hidden;\nuser-select:none;\n`\n\nconst ContainerButtons = styled.div`\ndisplay: flex;\nwidth: 100%;\nposition: absolute;\nbottom: 0;\nleft: 0;\nright: 0;\nheight: 3em;\nbackground-color: rgba(43, 51, 63, 0.7);\ncolor: white;\ntransition:  bottom .5s ease;\n`\n\nconst Spin = styled.div`\nheight: 100%;\noverflow: auto;\noverflow-y: auto;\nmax-width: 100%;\nwidth: 100%;\noverflow-x: hidden;\nbackground-color: transparent;\nposition: absolute;\nz-index: 5;\ntop: 0;\nleft: 0;\n\ndisplay:flex;\njustify-content:center;\nalign-items:center;\n\n`\n\nlet timeout = null;\nconst Player = () => {\n  const ref = useRef();\n\n  const playingChannel = useSelector(state => state.playingCh || {disabled:true});\n  const [play, setPlay] = useState(!!playingChannel);\n  const [volume, setVolume] = useState(50);\n  const [pip, setPip] = useState(false);\n  const [fullscreen, setFullscreen] = useState(false);\n\n  const [hoverStyle, setHoverStyle] = useState({bottom:\"-3rem\"});\n  const [showCursor, setShowCursor] = useState({cursor: \"\"})\n\n  const [url, setUrl] = useState();\n  const [isLoading, setIsLoading] = useState(false)\n  const [error, setError] = useState(false)\n\n  useEffect(() => {\n    if (ref.current) {\n      const elem = ref.current;\n      if (fullscreen) {\n        if (elem.requestFullscreen) {\n          elem.requestFullscreen();\n        } else if (elem.webkitRequestFullscreen) { /* Safari */\n          elem.webkitRequestFullscreen();\n        } else if (elem.msRequestFullscreen) { /* IE11 */\n          elem.msRequestFullscreen();\n        }\n        showOverlayTimer();\n      }\n      else {\n        setShowCursor({cursor: \"\"})\n        if (document.exitFullscreen) {\n          document.exitFullscreen().catch(() => { });\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    }\n  }, [fullscreen])\n\n  useEffect(() => {\n    if(!play)\n      showOverlay(true)\n  }, [play])\n  \n  useEffect(() => {\n    if (!playingChannel || playingChannel.disabled){\n      setIsLoading(false)\n      return;\n    }\n\n    setError(false)\n\n    let ip = playingChannel.direct_source ? convertTsToM3u8(playingChannel.direct_source) : generateUrl(\"live\", playingChannel.stream_id, \"m3u8\")\n\n    if (playingChannel.timeshift)\n      ip = catchupUrlGenerator(ip, playingChannel.timeshift, playingChannel.duration);\n\n      setUrl(ip)\n    setPlay(true)\n  }, [playingChannel])\n\n  const showOverlay = (show) =>{\n    setShowCursor({cursor: \"\"})\n    setHoverStyle({\n      bottom: show ? \"0rem\" : \"-3rem\"\n    })\n  }\n\n  const showOverlayTimer = () =>{\n    setShowCursor({cursor: \"\"})\n    clearTimeout(timeout);\n    showOverlay(true);\n    timeout = setTimeout(()=>{\n      showOverlay(false);\n      setShowCursor({cursor: \"none\"})\n    },4000);\n  }\n \n\n    return (\n      <PlayerDiv ref={ref} \n      onDoubleClick={() => setFullscreen(!fullscreen)} \n      onMouseEnter={()=> showOverlay(true)} \n      onMouseLeave = {()=> showOverlay(false)} \n      onMouseMove={() => fullscreen && showOverlayTimer()} \n      style={showCursor}>\n        <ReactPlayer\n         className='react-player'\n         width='100%'\n         height='100%'\n         playing={play}\n         volume={volume/100}\n         url={url}\n         pip={pip}\n         controls={false}\n         onProgress={(state)=>{\n          setError(false)\n         }}\n         onPlay={()=>{\n          setError(false)\n        }}\n         onError={(error, data)=> {\n          setError(true)\n          setIsLoading(false)\n         }}\n         onBufferEnd={()=>{\n          setError(false)\n          setIsLoading(false)\n         }}\n         onBuffer={()=>{\n          setIsLoading(true);\n          setError(false)\n        }}\n        />\n        { isLoading === true && (<Spin>\n            <Loading color={\"var(--second-color);\"}>\n                <div>\n                  <div />\n                  <div />\n                  <div />\n                </div>\n            </Loading>\n        </Spin>)}\n        {error === true ? (<Spin>\n          <label style={{color:\"white\"}}>An error occurred. Can't play stream.</label>\n        </Spin>)\n        :\n        <>\n        <Fullscreen externalShow={fullscreen && hoverStyle.bottom !== \"-3rem\"} cTitle={playingChannel.title} cDesc={playingChannel.desc} cDuration={playingChannel.duration}/>\n        <ContainerButtons dir=\"ltr\" style={hoverStyle}>\n        \t<Button enabled={play} onClick={() => setPlay(!play)} iconOn={\"fas fa-play\"} iconOff={\"fas fa-pause\"} textOn={\"Play\"} textOff={\"Pause\"}/>\n          <VolumeButton enabled={volume===0} onClick={() => setVolume(0)} onChangeInput={(e) => setVolume(e.target.value)} volume={volume}/>\n          <PiPButton enabled={pip} onClick={() => setPip(!pip)}/>\n          <Button enabled={fullscreen} onClick={() => setFullscreen(!fullscreen)} iconOn={\"fas fa-expand\"} iconOff={\"fas fa-compress\"} textOn={\"Fullscreen\"} textOff={\"Exit fullscreen\"}/>\n        </ContainerButtons>\n        </>\n      }\n      </PlayerDiv>\n      \n    )\n}\n\nexport default Player\n"]},"metadata":{},"sourceType":"module"}