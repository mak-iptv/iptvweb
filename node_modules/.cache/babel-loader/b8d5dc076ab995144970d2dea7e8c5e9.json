{"ast":null,"code":"import _objectSpread from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\rayuv\\\\OneDrive\\\\Documents\\\\GitHub\\\\Reactv\\\\src\\\\components\\\\Series\\\\PlayerSeries.js\",\n    _templateObject,\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport ReactNetflixPlayer from \"../../other/Player-github/player-github\";\nimport styled from 'styled-components';\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { optimizeName } from \"../../other/vod-series-name-optimizer\";\nimport { useSelector } from \"react-redux\";\nimport DB from \"../../other/local-db\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar Container = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\nposition:absolute;\\nwidth: 100%;\\nheight: 100%;\\ntop: 0;\\nleft: 0;\\n\"])));\n_c = Container;\n\nvar PlayerSeries = function PlayerSeries() {\n  _s();\n\n  var _useParams = useParams(),\n      category = _useParams.category,\n      season = _useParams.season,\n      episode = _useParams.episode,\n      stream_id = _useParams.stream_id;\n\n  var history = useHistory();\n  var tvseries = useSelector(function (state) {\n    return state.playlist;\n  }).find(function (x) {\n    return parseInt(x.series_id) === parseInt(stream_id);\n  }).name;\n  var streamsTemp = useSelector(function (state) {\n    return state.playlistEpisodes;\n  });\n  /*.map(x => {\n  return {\n  ...x,\n  playing: parseInt(x.episode_num) === parseInt(episode)\n  }\n  });*/\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      stream = _useState2[0],\n      setStream = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      streams = _useState4[0],\n      setStreams = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      streamStat = _useState6[0],\n      setStreamStat = _useState6[1];\n\n  useEffect(function () {\n    if (!streamsTemp || streamsTemp.length === 0) {\n      history.replace(\"/series/\");\n      return;\n    }\n\n    setStreams(streamsTemp.map(function (x) {\n      return _objectSpread(_objectSpread({}, x), {}, {\n        playing: parseInt(x.episode_num || x.episode) === parseInt(episode),\n        id: x.episode_num || x.episode,\n        name: x.title\n      });\n    }));\n  }, [streamsTemp, episode]);\n  useEffect(function () {\n    if (streams && streams.length > 0) {\n      var s = streams.find(function (x) {\n        return x.playing === true;\n      });\n      /*if(!s.direct_source)\n          s.direct_source = generateUrl(\"series\", s.stream, s.container_extension)*/\n\n      var stat = DB.findOne(\"series\", stream_id);\n      (!stat || stat && (parseInt(stat.season) !== parseInt(season) || parseInt(stat.episode) !== parseInt(episode))) && (stat = {\n        id: stream_id,\n        season: season,\n        episode: s.id,\n        start: 0,\n        tot: 0\n      });\n      setStreamStat(stat);\n      DB.set(\"series\", stream_id, stat);\n      setStream(s);\n    }\n  }, [streams]);\n\n  var setStat = function setStat(stat) {\n    setStreamStat(stat);\n    DB.set(\"series\", stream_id, stat);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(ReactNetflixPlayer, {\n      src: stream && (stream.direct_source || stream.url || stream.url2),\n      title: stream && optimizeName(tvseries),\n      titleMedia: stream && optimizeName(tvseries),\n      extraInfoMedia: stream && optimizeName(stream.title),\n      backButton: function backButton() {\n        return history.goBack();\n      },\n      FullPlayer: true,\n      autoPlay: true,\n      startPosition: streamStat ? parseInt(streamStat.start) : 0,\n      overlayEnabled: true,\n      autoControllCloseEnabled: true,\n      Style: true,\n      primaryColor: \"var(--second-color)\",\n      secundaryColor: \"var(--first-color)\",\n      reprodutionList: streams,\n      playlistTitle: \"Season \" + season,\n      syncDuration: function syncDuration(duration, percentage) {\n        return setStat(_objectSpread(_objectSpread({}, streamStat), {}, {\n          start: duration,\n          tot: parseInt(percentage),\n          episode: episode,\n          season: season\n        }));\n      },\n      dataNext: function dataNext() {\n        var next = streams.find(function (x) {\n          return x.episode_num > stream.episode_num;\n        });\n        return {\n          title: next ? \"Next: \".concat(next.title) : \"\"\n        };\n      },\n      onClickItemListReproduction: function onClickItemListReproduction(id, playing) {\n        var next = streams.find(function (x) {\n          return x.episode_num === id;\n        });\n        history.replace(\"/series/category/\".concat(category, \"/\").concat(stream_id, \"/play/season/\").concat(season, \"/episode/\").concat(next.episode_num, \"/\"));\n      },\n      onEnded: function onEnded() {\n        if (stream) {\n          var next = streams.find(function (x) {\n            return x.episode_num > stream.episode_num;\n          });\n          if (!next) return history.back();else history.replace(\"/series/category/\".concat(category, \"/\").concat(stream_id, \"/play/season/\").concat(season, \"/episode/\").concat(next.episode_num, \"/\"));\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(PlayerSeries, \"2tjq/m2OOTUYzZavT3R1W5IYqek=\", false, function () {\n  return [useParams, useHistory, useSelector, useSelector];\n});\n\n_c2 = PlayerSeries;\nexport default PlayerSeries;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"PlayerSeries\");","map":{"version":3,"sources":["C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/src/components/Series/PlayerSeries.js"],"names":["React","useState","useEffect","ReactNetflixPlayer","styled","useParams","useHistory","optimizeName","useSelector","DB","Container","div","PlayerSeries","category","season","episode","stream_id","history","tvseries","state","playlist","find","x","parseInt","series_id","name","streamsTemp","playlistEpisodes","stream","setStream","streams","setStreams","streamStat","setStreamStat","length","replace","map","playing","episode_num","id","title","s","stat","findOne","start","tot","set","setStat","direct_source","url","url2","goBack","duration","percentage","next","back"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport ReactNetflixPlayer from \"../../other/Player-github/player-github\"\nimport styled from 'styled-components'\nimport {useParams,useHistory} from \"react-router-dom\";\nimport {optimizeName} from \"../../other/vod-series-name-optimizer\"\nimport {useSelector} from \"react-redux\"\nimport DB from \"../../other/local-db\"\n\nconst Container = styled.div`\nposition:absolute;\nwidth: 100%;\nheight: 100%;\ntop: 0;\nleft: 0;\n`\n\nconst PlayerSeries = () => {\n    const {category,season,episode, stream_id} = useParams();\n    const history = useHistory();\n\n    const tvseries = useSelector(state => state.playlist).find(x=> parseInt(x.series_id) === parseInt(stream_id)).name;\n    const streamsTemp = useSelector(state => state.playlistEpisodes)/*.map(x => {\n        return {\n            ...x,\n            playing: parseInt(x.episode_num) === parseInt(episode)\n        }\n    });*/\n\n    const [stream, setStream] = useState();\n    const [streams, setStreams] = useState([]);\n    const [streamStat, setStreamStat] = useState()\n\n    useEffect(()=>{\n        if(!streamsTemp || streamsTemp.length === 0){\n            history.replace(`/series/`);\n            return;\n        }\n        setStreams(streamsTemp.map(x => {\n            return {\n                ...x,\n                playing: parseInt(x.episode_num || x.episode) === parseInt(episode),\n                id: x.episode_num || x.episode,\n                name: x.title\n            }\n        }))\n    },[streamsTemp,episode])\n    \n    useEffect(()=>{\n        if(streams && streams.length>0){\n            const s = streams.find(x=>x.playing===true)\n            /*if(!s.direct_source)\n                s.direct_source = generateUrl(\"series\", s.stream, s.container_extension)*/\n\n            let stat = DB.findOne(\"series\",stream_id);\n            (!stat || (stat && (parseInt(stat.season) !== parseInt(season) || parseInt(stat.episode) !== parseInt(episode)))) && (stat={id: stream_id, season: season, episode: s.id, start:0, tot:0}) \n            setStreamStat(stat)\n            DB.set(\"series\",stream_id, stat)\n            \n            setStream(s);\n        }\n    },[streams])\n\n    const setStat = (stat) =>{\n        setStreamStat(stat);\n        DB.set(\"series\",stream_id, stat)\n    }\n\n    return (\n        <Container>\n            <ReactNetflixPlayer\n            src={stream && (stream.direct_source || stream.url || stream.url2)}\n            title={stream && (optimizeName(tvseries))}\n            titleMedia={stream && (optimizeName(tvseries))}\n            extraInfoMedia = {stream && (optimizeName(stream.title))}\n            backButton={()=> history.goBack()}\n            FullPlayer\n            autoPlay\n            startPosition={streamStat ? parseInt(streamStat.start) : 0}\n            overlayEnabled\n            autoControllCloseEnabled\n            Style\n            primaryColor=\"var(--second-color)\"\n            secundaryColor=\"var(--first-color)\"\n            reprodutionList={streams}\n            playlistTitle = {\"Season \" + season}\n            syncDuration = {(duration, percentage) => setStat({...streamStat, start:duration, tot : parseInt(percentage), episode: episode, season: season})}\n\n            dataNext={()=>{\n                let next = streams.find(x=>x.episode_num > stream.episode_num);\n                return { title: next ? `Next: ${next.title}` : \"\"}\n            }}\n\n            onClickItemListReproduction={(id, playing) => {\n                let next = streams.find(x=>x.episode_num === id);\n                history.replace(`/series/category/${category}/${stream_id}/play/season/${season}/episode/${next.episode_num}/`)\n            }}\n\n            onEnded={() => {\n                if(stream){\n                    let next = streams.find(x=>x.episode_num > stream.episode_num);\n                    if(!next)\n                        return history.back();\n                    else history.replace(`/series/category/${category}/${stream_id}/play/season/${season}/episode/${next.episode_num}/`)\n                }\n            }}\n\n            />\n        </Container>\n    )\n}\n\nexport default PlayerSeries\n"]},"metadata":{},"sourceType":"module"}