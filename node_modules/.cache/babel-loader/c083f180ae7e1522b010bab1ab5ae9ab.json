{"ast":null,"code":"import _objectSpread from \"C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { getInfo } from \"./user_info\";\nvar history = {\n  live: [],\n  movie: [],\n  series: []\n};\nvar favorite = {\n  live: [],\n  movie: [],\n  series: []\n};\nexport var initDb = function initDb() {\n  var txt = localStorage.getItem(\"history-\" + getInfo().username);\n  txt ? history = JSON.parse(txt) : saveDB(0);\n  txt = localStorage.getItem(\"favorite-\" + getInfo().username);\n  txt ? favorite = JSON.parse(txt) : saveDB(1);\n};\n\nvar findOne = function findOne(type, key, fav) {\n  var db = getDb(fav);\n  var el = db[type].find(function (x) {\n    return parseInt(x.id) === parseInt(key);\n  });\n  if (!el) return null;\n  return el && fav !== true ? _objectSpread(_objectSpread({}, el), {}, {\n    date: new Date(el.date)\n  }) : el;\n};\n\nvar findAll = function findAll(type, fav) {\n  if (fav !== true) return history[type].sort(function (a, b) {\n    return a.date - b.date;\n  }).map(function (x) {\n    return _objectSpread(_objectSpread({}, x), {}, {\n      date: new Date(x.date)\n    });\n  });else return favorite[type];\n};\n\nvar set = function set(type, key, value, fav) {\n  var db = getDb(fav);\n  fav !== true && (value = _objectSpread(_objectSpread({}, value), {}, {\n    date: Date.now()\n  }));\n  var i = db[type].findIndex(function (x) {\n    return x.id === key;\n  });\n  i !== -1 ? db[type][i] = value : db[type].unshift(value);\n  reorderDB(fav);\n  saveDB(fav);\n};\n\nvar del = function del(type, key, fav) {\n  if (fav !== true) history[type] = history[type].filter(function (x) {\n    return parseInt(x.id) !== parseInt(key);\n  });else favorite[type] = favorite[type].filter(function (x) {\n    return parseInt(x.id) !== parseInt(key);\n  });\n  saveDB(fav);\n};\n\nvar reorderDB = function reorderDB(fav) {\n  if (fav !== true) {\n    history.live = history.live.slice(0, 20).sort(function (a, b) {\n      return b.date - a.date;\n    });\n    history.movie = history.movie.slice(0, 20).sort(function (a, b) {\n      return b.date - a.date;\n    });\n    history.series = history.series.slice(0, 20).sort(function (a, b) {\n      return b.date - a.date;\n    });\n  } else {\n    favorite.live = favorite.live.slice(0, 30);\n    favorite.movie = favorite.movie.slice(0, 30);\n    favorite.series = favorite.series.slice(0, 30);\n  }\n};\n\nvar saveDB = function saveDB(fav) {\n  window.localStorage.setItem((fav !== true ? \"history-\" : \"favorite-\") + getInfo().username, JSON.stringify(fav !== true ? history : favorite));\n};\n\nvar getDb = function getDb(fav) {\n  return fav !== true ? history : favorite;\n};\n\nexport default {\n  findOne: findOne,\n  findAll: findAll,\n  set: set,\n  del: del\n};","map":{"version":3,"sources":["C:/Users/rayuv/OneDrive/Documents/GitHub/Reactv/src/other/local-db.js"],"names":["getInfo","history","live","movie","series","favorite","initDb","txt","localStorage","getItem","username","JSON","parse","saveDB","findOne","type","key","fav","db","getDb","el","find","x","parseInt","id","date","Date","findAll","sort","a","b","map","set","value","now","i","findIndex","unshift","reorderDB","del","filter","slice","window","setItem","stringify"],"mappings":"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","sourcesContent":["import {getInfo} from \"./user_info\"\n\nlet history = {live:[], movie:[], series:[]};\nlet favorite = {live:[], movie:[], series:[]};\n\nexport const initDb = () =>{\n  let txt = localStorage.getItem(\"history-\" + getInfo().username);\n  txt ? (history = JSON.parse(txt)) : saveDB(0);\n\n  txt = localStorage.getItem(\"favorite-\" + getInfo().username);\n  txt ? (favorite = JSON.parse(txt)) : saveDB(1);\n}\n\nconst findOne = (type, key, fav) =>{\n  const db = getDb(fav);\n  const el = db[type].find(x=>parseInt(x.id) === parseInt(key))\n  if(!el)\n    return null;\n  return el && fav !== true ? {...el, date: new Date(el.date)} : el;\n}\n\nconst findAll = (type, fav) =>{\n  if(fav !== true)\n    return history[type].sort((a,b)=> a.date-b.date).map(x=> {return {...x, date : new Date(x.date)}});\n  else return favorite[type];\n}\n\nconst set = (type,key,value, fav) =>{\n  const db = getDb(fav);\n  \n  fav !== true && (value = {...value, date: Date.now()})\n\n  const i = db[type].findIndex(x=>x.id === key);\n  i !== -1 ? db[type][i] = value : db[type].unshift(value) \n\n  reorderDB(fav);\n  saveDB(fav);\n}\n\nconst del = (type, key, fav) =>{\n  if(fav !== true)\n    history[type] = history[type].filter(x=> parseInt(x.id) !== parseInt(key));\n  else favorite[type] = favorite[type].filter(x=> parseInt(x.id) !== parseInt(key));\n\n  saveDB(fav);\n}\n\nconst reorderDB = (fav) =>{\n  if (fav !== true) {\n    history.live = history.live.slice(0, 20).sort((a, b) => b.date - a.date)\n    history.movie = history.movie.slice(0, 20).sort((a, b) => b.date - a.date)\n    history.series = history.series.slice(0, 20).sort((a, b) => b.date - a.date)\n  }else{\n    favorite.live = favorite.live.slice(0, 30)\n    favorite.movie = favorite.movie.slice(0, 30)\n    favorite.series = favorite.series.slice(0, 30)\n  }\n}\n\nconst saveDB = (fav) =>{\n  window.localStorage.setItem((fav !== true ? \"history-\" : \"favorite-\") + getInfo().username, JSON.stringify(fav !== true ? history : favorite));\n}\n\nconst getDb = fav => fav !== true ? history : favorite\n\nexport default {findOne, findAll, set, del}"]},"metadata":{},"sourceType":"module"}